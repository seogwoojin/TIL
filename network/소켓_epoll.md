# 서버는 OS의 어떤 함수를 이용해서 어떤 식으로 요청을 처리할까?

우선 서버를 실행하며 리스닝 소켓을 열어야 한다.

이후 클라이언트 요청이 들어올 것. -> HTTP기준 TCP 전송 계층에서 3-way 핸드셰이크 진행

핸드셰이크 완료와 동시에, 커널은 이제 이 연결을 “완료 연결 큐”로 옮기고, 이 시점에 내부적으로 해당 연결을 위한 소켓 구조체(struct socket)와 파일 디스크립터(fd)를 준비합니다.

<img width="955" alt="스크린샷 2025-04-18 오후 2 45 25" src="https://github.com/user-attachments/assets/1bb94bff-1904-4295-adb1-d9ad15334f50" />

<br/>

이제 좀 꼬였던 게 정리가 되는 것 같은데, 흔히 말하는 소켓은 그냥 구조체인듯하다. 

또 이 소켓은 5가지 요소를 통해 구분이 되며, 이 소켓 객체를 가르키는 포인터가 프로세스의 파일 디스크립터(fd) 테이블에 올라가게 됩니다.

서버가 지속적인 epoll_wait()를 통해 “읽기 가능” 이벤트를 받고, 그 뒤 accept(epfd, …) 를 호출하면 얻는 int가 “새로운 연결 전용 소켓”을 가리키는 파일 디스크립터입니다.

<img width="801" alt="스크린샷 2025-04-18 오후 2 51 54" src="https://github.com/user-attachments/assets/48ebeef3-59de-4e51-b4d6-3a15e8591dd6" />

그러니 소켓이라는 파일에 Read Write를 한다고 생각하면 된다는 개념이 얼추 맞으나, **정확히 말하면 운영체제에게 특정 소켓 구조체를 활용해 이러이러한 작업을 해달라고 요청하는 게 맞는 것이다.**

